images:
  build-floor-alpine:
    units:
      - image: barney.ci/alpine%pkg/alpine-base
      - image: barney.ci/alpine%network
      - image: barney.ci/alpine%pkg/busybox
      - image: barney.ci/alpine%pkg/coreutils

  minimal-source:
    no-create-mountpoints: true
    units:
      - build: |
          mkdir -p /dest/usr/lib/python3.11/site-packages/pybsn/
          cp pybsn/__init__.py /dest/usr/lib/python3.11/site-packages/pybsn/

  minimal-source-py39:
    no-create-mountpoints: true
    units:
      - build: |
          mkdir -p /dest/usr/lib/python3.9/site-packages/pybsn/
          cp pybsn/__init__.py /dest/usr/lib/python3.9/site-packages/pybsn/

  pybsn-install-floor:
    units:
      - floor:
        build: |
          mkdir -p /dest/pybsn/
          cp pybsn/__init__.py /dest/pybsn/
          echo '#!/bin/sh
                SRC_DIR=$(dirname "$0")
                DEST_PYTHON_SITE_PKGS=`python3 -c "import site; print(site.getsitepackages()[0])"`
                DEST_PYTHON_SITE_PKGS=/dest${DEST_PYTHON_SITE_PKGS}
                mkdir -p ${DEST_PYTHON_SITE_PKGS}/pybsn/
                cp ${SRC_DIR}/__init__.py ${DEST_PYTHON_SITE_PKGS}/pybsn/
          ' > /dest/pybsn/install_pybsn
          chmod 777 /dest/pybsn/install_pybsn

